VERSION 5.00
Begin VB.Form Form1 
   BorderStyle     =   5  'Sizable ToolWindow
   Caption         =   "Form1"
   ClientHeight    =   8745
   ClientLeft      =   120
   ClientTop       =   390
   ClientWidth     =   16455
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   8745
   ScaleWidth      =   16455
   ShowInTaskbar   =   0   'False
   StartUpPosition =   3  'Windows Default
   Begin VB.TextBox Text1 
      Height          =   735
      Left            =   10080
      TabIndex        =   65
      Top             =   720
      Width           =   1695
   End
   Begin VB.CommandButton Command1 
      Caption         =   "START"
      Height          =   1455
      Left            =   9720
      TabIndex        =   64
      Top             =   2280
      Width           =   3735
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   63
      Left            =   7560
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   63
      Top             =   6600
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   62
      Left            =   6600
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   62
      Top             =   6600
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   61
      Left            =   5640
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   61
      Top             =   6600
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   60
      Left            =   4680
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   60
      Top             =   6600
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   59
      Left            =   3720
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   59
      Top             =   6600
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   58
      Left            =   2760
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   58
      Top             =   6600
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   57
      Left            =   1800
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   57
      Top             =   6600
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   56
      Left            =   840
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   56
      Top             =   6600
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   55
      Left            =   7560
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   55
      Top             =   5760
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   54
      Left            =   6600
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   54
      Top             =   5760
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   53
      Left            =   5640
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   53
      Top             =   5760
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   52
      Left            =   4680
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   52
      Top             =   5760
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   51
      Left            =   3720
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   51
      Top             =   5760
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   50
      Left            =   2760
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   50
      Top             =   5760
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   49
      Left            =   1800
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   49
      Top             =   5760
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   48
      Left            =   840
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   48
      Top             =   5760
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   47
      Left            =   7560
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   47
      Top             =   4920
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   46
      Left            =   6600
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   46
      Top             =   4920
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   45
      Left            =   5640
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   45
      Top             =   4920
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   44
      Left            =   4680
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   44
      Top             =   4920
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   43
      Left            =   3720
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   43
      Top             =   4920
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   42
      Left            =   2760
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   42
      Top             =   4920
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   41
      Left            =   1800
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   41
      Top             =   4920
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   40
      Left            =   840
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   40
      Top             =   4920
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   39
      Left            =   7560
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   39
      Top             =   4080
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   38
      Left            =   6600
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   38
      Top             =   4080
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   37
      Left            =   5640
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   37
      Top             =   4080
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   36
      Left            =   4680
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   36
      Top             =   4080
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   35
      Left            =   3720
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   35
      Top             =   4080
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   34
      Left            =   2760
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   34
      Top             =   4080
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   33
      Left            =   1800
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   33
      Top             =   4080
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   32
      Left            =   840
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   32
      Top             =   4080
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   31
      Left            =   7560
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   31
      Top             =   3240
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   30
      Left            =   6600
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   30
      Top             =   3240
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   29
      Left            =   5640
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   29
      Top             =   3240
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   28
      Left            =   4680
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   28
      Top             =   3240
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   27
      Left            =   3720
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   27
      Top             =   3240
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   26
      Left            =   2760
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   26
      Top             =   3240
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   25
      Left            =   1800
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   25
      Top             =   3240
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   24
      Left            =   840
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   24
      Top             =   3240
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   23
      Left            =   7560
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   23
      Top             =   2400
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   22
      Left            =   6600
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   22
      Top             =   2400
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   21
      Left            =   5640
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   21
      Top             =   2400
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   20
      Left            =   4680
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   20
      Top             =   2400
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   19
      Left            =   3720
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   19
      Top             =   2400
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   18
      Left            =   2760
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   18
      Top             =   2400
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   17
      Left            =   1800
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   17
      Top             =   2400
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   16
      Left            =   840
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   16
      Top             =   2400
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   15
      Left            =   7560
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   15
      Top             =   1560
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   14
      Left            =   6600
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   14
      Top             =   1560
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   13
      Left            =   5640
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   13
      Top             =   1560
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   12
      Left            =   4680
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   12
      Top             =   1560
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   11
      Left            =   3720
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   11
      Top             =   1560
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   10
      Left            =   2760
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   10
      Top             =   1560
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   9
      Left            =   1800
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   9
      Top             =   1560
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   8
      Left            =   840
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   8
      Top             =   1560
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   7
      Left            =   7560
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   7
      Top             =   720
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   6
      Left            =   6600
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   6
      Top             =   720
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   5
      Left            =   5640
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   5
      Top             =   720
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   4
      Left            =   4680
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   4
      Top             =   720
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H00000000&
      Height          =   855
      Index           =   3
      Left            =   3720
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   3
      Top             =   720
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      Height          =   855
      Index           =   2
      Left            =   2760
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   2
      Top             =   720
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H80000007&
      Height          =   855
      Index           =   1
      Left            =   1800
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   1
      Top             =   720
      Width           =   975
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H8000000E&
      BeginProperty DataFormat 
         Type            =   1
         Format          =   ""
         HaveTrueFalseNull=   0
         FirstDayOfWeek  =   0
         FirstWeekOfYear =   0
         LCID            =   16393
         SubFormatType   =   0
      EndProperty
      ForeColor       =   &H8000000D&
      Height          =   855
      Index           =   0
      Left            =   840
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   0
      Top             =   720
      Width           =   975
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim rr(7), rl(7), ru(7), rd(7), bru(7), blu(7), bld(7), brd(7), rrc, rlc, ruc, rdc, bruc, bluc, bldc, brdc As Integer
Dim startflag, clickflag, mov(50), kill(10), cnt, cnt1, playerflag, temp, previous, kingflag, kingmov(60), kingcnt As Integer


Private Sub Command1_Click()
startflag = 1
Picture1_Click (1)
End Sub

Public Sub Picture1_Click(index As Integer)

If startflag = 1 Then
    playerflag = 0
    For i = 0 To 63
        Picture1(i).Tag = 0
        Picture1(i).Picture = Nothing
    Next
    For i = 48 To 55
        Picture1(i).Picture = LoadPicture("e:\chess\pawn.jpg")
        Picture1(i).Tag = 110
    Next
    Picture1(36).Picture = LoadPicture("e:\chess\rook.jpg")
    Picture1(63).Picture = LoadPicture("e:\chess\rook.jpg")
    Picture1(36).Tag = 120
    Picture1(63).Tag = 120
    Picture1(57).Picture = LoadPicture("e:\chess\knight.jpg")
    Picture1(62).Picture = LoadPicture("e:\chess\knight.jpg")
    Picture1(57).Tag = 130
    Picture1(62).Tag = 130
    Picture1(58).Picture = LoadPicture("e:\chess\bishop.jpg")
    Picture1(61).Picture = LoadPicture("e:\chess\bishop.jpg")
    Picture1(58).Tag = 140
    Picture1(61).Tag = 140
    Picture1(59).Picture = LoadPicture("e:\chess\queen.jpg")
    Picture1(59).Tag = 150
    Picture1(35).Picture = LoadPicture("e:\chess\king.jpg")
    Picture1(35).Tag = 160
    
    For i = 8 To 15
        Picture1(i).Picture = LoadPicture("e:\chess\pawnbl.jpg")
        Picture1(i).Tag = 210
    Next
    Picture1(39).Picture = LoadPicture("e:\chess\rookbl.jpg")
    Picture1(7).Picture = LoadPicture("e:\chess\rookbl.jpg")
    Picture1(39).Tag = 220
    Picture1(7).Tag = 220
    Picture1(1).Picture = LoadPicture("e:\chess\knightbl.jpg")
    Picture1(6).Picture = LoadPicture("e:\chess\knightbl.jpg")
    Picture1(1).Tag = 230
    Picture1(6).Tag = 230
    Picture1(2).Picture = LoadPicture("e:\chess\bishopbl.jpg")
    Picture1(5).Picture = LoadPicture("e:\chess\bishopbl.jpg")
    Picture1(2).Tag = 240
    Picture1(5).Tag = 240
    Picture1(3).Picture = LoadPicture("e:\chess\queenbl.jpg")
    Picture1(3).Tag = 250
    Picture1(4).Picture = LoadPicture("e:\chess\kingbl.jpg")
    Picture1(4).Tag = 260
    startflag = 0

Else
    
    For i = 0 To cnt - 1
        temp = mov(i)
        row = (temp \ 8)
        If temp Mod 2 = 0 And row Mod 2 = 0 Then
            Picture1(temp).BackColor = &H8000000E
        ElseIf temp Mod 2 = 1 And row Mod 2 = 1 Then
            Picture1(temp).BackColor = &H8000000E
        Else
            Picture1(temp).BackColor = &H80000007
        End If
    Next
    
    If (Picture1(index).Tag < 200) And playerflag = 0 Then
            If Picture1(previous).Tag = 111 And previous > 47 Then
                Picture1(previous).Tag = 110
            End If
    End If
    
    If Picture1(index).Tag > 200 And playerflag = 1 Then
        If Picture1(previous).Tag = 211 And previous < 8 Then
            Picture1(previous).Tag = 210
        End If
    End If

    For i = 0 To cnt - 1
        If index = mov(i) Then
            Picture1(index).Picture = Picture1(previous).Picture
            Picture1(index).Tag = Picture1(previous).Tag
            Picture1(previous).Picture = Nothing
            Picture1(previous).Tag = 0
            If playerflag = 0 Then
                playerflag = 1
            Else
                playerflag = 0
            End If
        End If
    Next
    
    If clickflag = 0 Then
        For i = 0 To 50
            mov(i) = 0
            If i < 10 Then
                kill(i) = 0
            End If
        Next
        cnt = 0
        Text1.Text = playerflag
        cnt1 = 0
        If playerflag = 0 Then
            If Picture1(index).Tag > 109 And Picture1(index).Tag < 120 Then
                t = wpawn(index)
            ElseIf Picture1(index).Tag > 119 And Picture1(index).Tag < 130 Then
                t = wrook(index)
            ElseIf Picture1(index).Tag > 129 And Picture1(index).Tag < 139 Then
                t = wknight(index)
            ElseIf Picture1(index).Tag > 139 And Picture1(index).Tag < 149 Then
                t = wbishap(index)
            ElseIf Picture1(index).Tag > 149 And Picture1(index).Tag < 159 Then
                t = wbishap(index)
                t = wrook(index)
            End If
        Else
            If Picture1(index).Tag > 209 And Picture1(index).Tag < 220 Then
                t = bpawn(index)
            ElseIf Picture1(index).Tag > 219 And Picture1(index).Tag < 230 Then
                t = brook(index)
            ElseIf Picture1(index).Tag > 229 And Picture1(index).Tag < 239 Then
                t = bknight(index)
            ElseIf Picture1(index).Tag > 239 And Picture1(index).Tag < 249 Then
                t = bbishap(index)
            ElseIf Picture1(index).Tag > 249 And Picture1(index).Tag < 259 Then
                t = bbishap(index)
                t = brook(index)
            End If
        End If
        clickflag = 1
    End If
    
    If clickflag = 1 Then 'start of valid moves
        For i = 0 To cnt - 1
            temp = mov(i)
            Picture1(temp).BackColor = &H80FF80
        Next
        For i = 0 To cnt1 - 1
            temp = kill(i)
            Picture1(temp).BackColor = &HFF
        Next
        clickflag = 0
        previous = index
    End If 'end of select piece if
    
    
End If 'end of start if

End Sub

Function wpawn(index As Integer)

If Picture1(index).Tag = 110 Then 'start of white pawn
    If Picture1(index - 16).Tag = 0 Then
        If Picture1(index - 8).Tag = 0 And kingflag <> 1 Then
            mov(cnt) = index - 16
            cnt = cnt + 1
        End If
    End If
    Picture1(index).Tag = 111
End If
If Picture1(index).Tag = 111 Then   'any white pawn
    row = index \ 8 - 1
    If Picture1(index - 8).Tag = 0 And kingflag <> 1 Then
        mov(cnt) = index - 8
        cnt = cnt + 1
    End If
    If Picture1(index - 7).Tag > 200 Then
        If ((index - 7) \ 8) = row Then
            mov(cnt) = index - 7
            kill(cnt1) = index - 7
            cnt = cnt + 1
            cnt1 = cnt1 + 1
        End If
    End If
    If Picture1(index - 9).Tag > 200 Then
        If ((index - 9) \ 8) = row Then
            mov(cnt) = index - 9
            kill(cnt1) = index - 9
            cnt = cnt + 1
            cnt1 = cnt1 + 1
        End If
    End If
End If 'end of white pawn

End Function


Function bpawn(index As Integer)

If Picture1(index).Tag = 210 Then 'start of Black pawn
    If Picture1(index + 16).Tag = 0 Then
        If Picture1(index + 8).Tag = 0 And kingflag <> 1 Then
            mov(cnt) = index + 16
            cnt = cnt + 1
        End If
    End If
    Picture1(index).Tag = 211
End If

If Picture1(index).Tag = 211 Then 'Any Black pawn
    row = index \ 8 + 1
    If Picture1(index + 8).Tag = 0 And kingflag <> 1 Then
        mov(cnt) = index + 8
        cnt = cnt + 1
    End If
    If Picture1(index + 7).Tag < 200 And Picture1(index + 7).Tag > 100 Then
        If (index + 7) \ 8 = row Then
            mov(cnt) = index + 7
            kill(cnt1) = index + 7
            cnt = cnt + 1
            cnt1 = cnt1 + 1
        End If
    End If
    If Picture1(index + 9).Tag < 200 And Picture1(index + 9).Tag > 100 Then
        If (index + 9) \ 8 = row Then
            mov(cnt) = index + 9
            kill(cnt1) = index + 9
            cnt = cnt + 1
            cnt1 = cnt1 + 1
        End If
    End If
End If 'end of Black pawn
    
End Function


Function wrook(index As Integer)
        
row = index \ 8
i = index
Do While 1
    flag = 0
    If (i + 1) \ 8 = row And (i + 1) < 64 Then
        If Picture1(i + 1).Tag = 0 Or Picture1(i + 1).Tag > 200 Then
            If Picture1(i + 1).Tag > 200 Then
                flag = 1
            End If
            i = i + 1
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i).Tag > 0 Then
                kill(cnt1) = i
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i + 1) \ 8 <> row Or i + 1 > 63 Then
        Exit Do
    End If
Loop
i = index
Do While 1
    flag = 0
    If (i - 1) \ 8 = row And (i - 1) >= 0 Then
        If Picture1(i - 1).Tag = 0 Or Picture1(i - 1).Tag > 200 Then
            If Picture1(i - 1).Tag > 200 Then
                flag = 1
            End If
            i = i - 1
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i).Tag > 0 Then
                kill(cnt1) = i
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i - 1) \ 8 <> row Or i - 1 < 0 Then
        Exit Do
    End If
Loop
i = index
Do While 1
    flag = 0
    If (i + 8) < 64 Then
        If Picture1(i + 8).Tag = 0 Or Picture1(i + 8).Tag > 200 Then
            If Picture1(i + 8).Tag > 200 Then
                flag = 1
            End If
            i = i + 8
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i).Tag > 0 Then
                kill(cnt1) = i
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i + 8) >= 64 Then
        Exit Do
    End If
Loop
i = index
Do While 1
    flag = 0
    If (i - 8) >= 0 Then
        If Picture1(i - 8).Tag = 0 Or Picture1(i - 8).Tag > 200 Then
            If Picture1(i - 8).Tag > 200 Then
                flag = 1
            End If
            i = i - 8
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i).Tag > 0 Then
                kill(cnt1) = i
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i - 8) < 0 Then
        Exit Do
    End If
Loop

End Function

Function brook(index As Integer)
        
row = index \ 8
i = index
Do While 1
    flag = 0
    If (i + 1) \ 8 = row And (i + 1) < 64 Then
        If Picture1(i + 1).Tag = 0 Or (Picture1(i + 1).Tag > 100 And Picture1(i + 1).Tag < 200) Then
            If Picture1(i + 1).Tag > 100 And Picture1(i + 1).Tag < 200 Then
                flag = 1
            End If
            i = i + 1
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i).Tag > 0 Then
                kill(cnt1) = i
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i + 1) \ 8 <> row Or i + 1 > 63 Then
        Exit Do
    End If
Loop
i = index
Do While 1
    flag = 0
    If (i - 1) \ 8 = row And i - 1 >= 0 Then
        If Picture1(i - 1).Tag = 0 Or (Picture1(i - 1).Tag > 100 And Picture1(i - 1).Tag < 200) Then
            If Picture1(i + 1).Tag > 100 And Picture1(i + 1).Tag < 200 Then
                flag = 1
            End If
            i = i - 1
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i).Tag > 0 Then
                kill(cnt1) = i
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i - 1) \ 8 <> row Or i - 1 < 0 Then
        Exit Do
    End If
Loop
i = index
Do While 1
    flag = 0
    If (i + 8) < 64 Then
        If Picture1(i + 8).Tag = 0 Or (Picture1(i + 8).Tag > 100 And Picture1(i + 8).Tag < 200) Then
            If Picture1(i + 1).Tag > 100 And Picture1(i + 1).Tag < 200 Then
                flag = 1
            End If
            i = i + 8
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i).Tag > 0 Then
                kill(cnt1) = i
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i + 8) >= 64 Then
        Exit Do
    End If
Loop
i = index
Do While 1
    flag = 0
    If (i - 8) >= 0 Then
        If Picture1(i - 8).Tag = 0 Or (Picture1(i - 8).Tag > 100 And Picture1(i - 8).Tag < 200) Then
            If Picture1(i + 1).Tag > 100 And Picture1(i + 1).Tag < 200 Then
                flag = 1
            End If
            i = i - 8
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i).Tag > 0 Then
                kill(cnt1) = i
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i - 8) < 0 Then
        Exit Do
    End If
Loop

End Function

Function wknight(index As Integer)

row = index \ 8
i = index

If (i + 6) \ 8 = (row + 1) And (row + 1) < 8 Then
    If Picture1(i + 6).Tag = 0 Or Picture1(i + 6).Tag > 200 Then
        If Picture1(i + 6).Tag > 200 Then
            kill(cnt1) = i + 6
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i + 6
        cnt = cnt + 1
    End If
End If

If (i + 10) \ 8 = (row + 1) And (row + 1) < 8 Then
    If Picture1(i + 10).Tag = 0 Or Picture1(i + 10).Tag > 200 Then
        If Picture1(i + 10).Tag > 200 Then
            kill(cnt1) = i + 10
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i + 10
        cnt = cnt + 1
    End If
End If

If (i - 6) \ 8 = (row - 1) And (row - 1) >= 0 Then
    If Picture1(i - 6).Tag = 0 Or Picture1(i - 6).Tag > 200 Then
        If Picture1(i - 6).Tag > 200 Then
            kill(cnt1) = i - 6
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i - 6
        cnt = cnt + 1
    End If
End If

If (i - 10) \ 8 = (row - 1) And (row - 1) >= 0 Then
    If Picture1(i - 10).Tag = 0 Or Picture1(i - 10).Tag > 200 Then
        If Picture1(i - 10).Tag > 200 Then
            kill(cnt1) = i - 10
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i - 10
        cnt = cnt + 1
    End If
End If

If (i + 15) \ 8 = (row + 2) And (row + 2) < 8 Then
    If Picture1(i + 15).Tag = 0 Or Picture1(i + 15).Tag > 200 Then
        If Picture1(i + 15).Tag > 200 Then
            kill(cnt1) = i + 15
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i + 15
        cnt = cnt + 1
    End If
End If

If (i + 17) \ 8 = (row + 2) And (row + 2) < 8 Then
    If Picture1(i + 17).Tag = 0 Or Picture1(i + 17).Tag > 200 Then
        If Picture1(i + 17).Tag > 200 Then
            kill(cnt1) = i + 17
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i + 17
        cnt = cnt + 1
    End If
End If

If (i - 15) \ 8 = (row - 2) And (row - 2) >= 0 Then
    If Picture1(i - 15).Tag = 0 Or Picture1(i - 15).Tag > 200 Then
        If Picture1(i - 15).Tag > 200 Then
            kill(cnt1) = i - 15
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i - 15
        cnt = cnt + 1
    End If
End If

If (i - 17) \ 8 = (row - 2) And (row - 2) >= 0 Then
    If Picture1(i - 17).Tag = 0 Or Picture1(i - 17).Tag > 200 Then
        If Picture1(i - 17).Tag > 200 Then
            kill(cnt1) = i - 17
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i - 17
        cnt = cnt + 1
    End If
End If

End Function

Function bknight(index As Integer)

row = index \ 8
i = index

If (i + 6) \ 8 = (row + 1) And (row + 1) < 8 Then
    If Picture1(i + 6).Tag = 0 Or (Picture1(i + 6).Tag > 100 And Picture1(i + 6).Tag < 200) Then
        If (Picture1(i + 6).Tag > 100 And Picture1(i + 6).Tag < 200) Then
            kill(cnt1) = i + 6
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i + 6
        cnt = cnt + 1
    End If
End If

If (i + 10) \ 8 = (row + 1) And (row + 1) < 8 Then
    If Picture1(i + 10).Tag = 0 Or (Picture1(i + 10).Tag > 100 And Picture1(i + 10).Tag < 200) Then
        If (Picture1(i + 10).Tag > 100 And Picture1(i + 10).Tag < 200) Then
            kill(cnt1) = i + 10
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i + 10
        cnt = cnt + 1
    End If
End If

If (i - 6) \ 8 = (row - 1) And (row - 1) >= 0 Then
    If Picture1(i - 6).Tag = 0 Or (Picture1(i - 6).Tag > 100 And Picture1(i - 6).Tag < 200) Then
        If (Picture1(i - 6).Tag > 100 And Picture1(i - 6).Tag < 200) Then
            kill(cnt1) = i - 6
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i - 6
        cnt = cnt + 1
    End If
End If

If (i - 10) \ 8 = (row - 1) And (row - 1) >= 0 Then
    If Picture1(i - 10).Tag = 0 Or (Picture1(i - 10).Tag > 100 And Picture1(i - 10).Tag < 200) Then
        If (Picture1(i - 10).Tag > 100 And Picture1(i - 10).Tag < 200) Then
            kill(cnt1) = i - 10
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i - 10
        cnt = cnt + 1
    End If
End If

If (i + 15) \ 8 = (row + 2) And (row + 2) < 8 Then
    If Picture1(i + 15).Tag = 0 Or (Picture1(i + 15).Tag > 100 And Picture1(i + 15).Tag < 200) Then
        If (Picture1(i + 15).Tag > 100 And Picture1(i + 15).Tag < 200) Then
            kill(cnt1) = i + 15
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i + 15
        cnt = cnt + 1
    End If
End If

If (i + 17) \ 8 = (row + 2) And (row + 2) < 8 Then
    If Picture1(i + 17).Tag = 0 Or (Picture1(i + 17).Tag > 100 And Picture1(i + 17).Tag < 200) Then
        If (Picture1(i + 17).Tag > 100 And Picture1(i + 17).Tag < 200) Then
            kill(cnt1) = i + 17
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i + 17
        cnt = cnt + 1
    End If
End If

If (i - 15) \ 8 = (row - 2) And (row - 2) >= 0 Then
    If Picture1(i - 15).Tag = 0 Or (Picture1(i - 15).Tag > 100 And Picture1(i - 15).Tag < 200) Then
        If (Picture1(i - 15).Tag > 100 And Picture1(i - 15).Tag < 200) Then
            kill(cnt1) = i - 15
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i - 15
        cnt = cnt + 1
    End If
End If

If (i - 17) \ 8 = (row - 2) And (row - 2) >= 0 Then
    If Picture1(i - 17).Tag = 0 Or (Picture1(i - 17).Tag > 100 And Picture1(i - 17).Tag < 200) Then
        If (Picture1(i - 17).Tag > 100 And Picture1(i - 17).Tag < 200) Then
            kill(cnt1) = i - 17
            cnt1 = cnt1 + 1
        End If
        mov(cnt) = i - 17
        cnt = cnt + 1
    End If
End If

End Function

Function wbishap(index As Integer)
inc = 1
row = index \ 8
i = index
Do While 1
    flag = 0
    If (i + inc * 7) \ 8 = (inc + row) And (inc + row) < 8 Then
        If Picture1(i + inc * 7).Tag = 0 Or Picture1(i + inc * 7).Tag > 200 Then
            If Picture1(i + inc * 7).Tag > 200 Then
                flag = 1
            End If
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i + inc * 7).Tag > 0 Then
                kill(cnt1) = i + inc * 7
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i + inc * 7
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i + inc * 7) \ 8 <> (row + inc) Then
        Exit Do
    End If
    inc = inc + 1
Loop

inc = 1
i = index
Do While 1
    flag = 0
    If (i + inc * 9) \ 8 = (inc + row) And (inc + row) < 8 Then
        If Picture1(i + inc * 9).Tag = 0 Or Picture1(i + inc * 9).Tag > 200 Then
            If Picture1(i + inc * 9).Tag > 200 Then
                flag = 1
            End If
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i + inc * 9).Tag > 0 Then
                kill(cnt1) = i + inc * 9
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i + inc * 9
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i + inc * 9) \ 8 <> (row + inc) Then
        Exit Do
    End If
    inc = inc + 1
Loop

inc = 1
i = index
Do While 1
    flag = 0
    If (i - inc * 7) \ 8 = (row - inc) And (row - inc) >= 0 Then
        If Picture1(i - inc * 7).Tag = 0 Or Picture1(i - inc * 7).Tag > 200 Then
            If Picture1(i - inc * 7).Tag > 200 Then
                flag = 1
            End If
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i - inc * 7).Tag > 0 Then
                kill(cnt1) = i - inc * 7
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i - inc * 7
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i - inc * 7) \ 8 <> (row - inc) Then
        Exit Do
    End If
    inc = inc + 1
Loop

inc = 1
i = index
Do While 1
    flag = 0
    If (i - inc * 9) \ 8 = (row - inc) And (row - inc) >= 0 Then
        If Picture1(i - inc * 9).Tag = 0 Or Picture1(i - inc * 9).Tag > 200 Then
            If Picture1(i - inc * 9).Tag > 200 Then
                flag = 1
            End If
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i - inc * 9).Tag > 0 Then
                kill(cnt1) = i - inc * 9
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i - inc * 9
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i - inc * 9) \ 8 <> (row - inc) Then
        Exit Do
    End If
    inc = inc + 1
Loop

End Function

Function bbishap(index As Integer)
inc = 1
row = index \ 8
i = index
Do While 1
    flag = 0
    If (i + inc * 7) \ 8 = (inc + row) And (inc + row) < 8 Then
        If Picture1(i + inc * 7).Tag = 0 Or (Picture1(i + inc * 7).Tag > 100 And Picture1(i + inc * 7).Tag < 200) Then
            If (Picture1(i + inc * 7).Tag > 100 And Picture1(i + inc * 7).Tag < 200) Then
                flag = 1
            End If
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i + inc * 7).Tag > 0 Then
                kill(cnt1) = i + inc * 7
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i + inc * 7
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i + inc * 7) \ 8 <> (row + inc) Then
        Exit Do
    End If
    inc = inc + 1
Loop

inc = 1
i = index
Do While 1
    flag = 0
    If (i + inc * 9) \ 8 = (inc + row) And (inc + row) < 8 Then
        If Picture1(i + inc * 9).Tag = 0 Or (Picture1(i + inc * 9).Tag > 100 And Picture1(i + inc * 9).Tag < 200) Then
            If (Picture1(i + inc * 9).Tag > 100 And Picture1(i + inc * 9).Tag < 200) Then
                flag = 1
            End If
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i + inc * 9).Tag > 0 Then
                kill(cnt1) = i + inc * 9
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i + inc * 9
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i + inc * 9) \ 8 <> (row + inc) Then
        Exit Do
    End If
    inc = inc + 1
Loop

inc = 1
i = index
Do While 1
    flag = 0
    If (i - inc * 7) \ 8 = (row - inc) And (row - inc) >= 0 Then
        If Picture1(i - inc * 7).Tag = 0 Or (Picture1(i - inc * 7).Tag > 100 And Picture1(i - inc * 7).Tag < 200) Then
            If (Picture1(i - inc * 7).Tag > 100 And Picture1(i - inc * 7).Tag < 200) Then
                flag = 1
            End If
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i - inc * 7).Tag > 0 Then
                kill(cnt1) = i - inc * 7
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i - inc * 7
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i - inc * 7) \ 8 <> (row - inc) Then
        Exit Do
    End If
    inc = inc + 1
Loop

inc = 1
i = index
Do While 1
    flag = 0
    If (i - inc * 9) \ 8 = (row - inc) And (row - inc) >= 0 Then
        If Picture1(i - inc * 9).Tag = 0 Or (Picture1(i - inc * 9).Tag > 100 And Picture1(i - inc * 9).Tag < 200) Then
            If (Picture1(i - inc * 9).Tag > 100 And Picture1(i - inc * 9).Tag < 200) Then
                flag = 1
            End If
        Else
            flag = 2
        End If
        If flag <> 2 Then
            If Picture1(i - inc * 9).Tag > 0 Then
                kill(cnt1) = i - inc * 9
                cnt1 = cnt1 + 1
            End If
            mov(cnt) = i - inc * 9
            cnt = cnt + 1
        End If
    End If
    If flag <> 0 Or (i - inc * 9) \ 8 <> (row - inc) Then
        Exit Do
    End If
    inc = inc + 1
Loop

End Function
 
Function wking(index As Integer)
bflag = 0
cntw = 0
wpindex = 0
row = index \ 8
i = index
Do While 1
    flag = 0
    If (i + 1) \ 8 = row And (i + 1) < 64 Then
         If Picture1(i + 1).Tag > 100 And Picture1(i + 1).Tag < 200 Then
             wpindex = i + 1
             cntw = cntw + 1
         End If
        If Picture1(i + 1).Tag > 200 Then
             bflag = 1
             whitemov(whitecnt) = i + 1
             whitecnt = whitecnt + 1
            Exit Do
         End If
         If cntw = 2 Then
             Exit Do
         End If
         whitemov(whitecnt) = i + 1
         whitecnt = whitecnt + 1
         i = i + 1
     End If
Loop

If cntw = 2 Then
whitecnt = 0
End If
If bflag = 1 And cntw = 1 Then


